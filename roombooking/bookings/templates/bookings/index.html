<!-- roombooking/bookings/templates/bookings/index.html -->

{% extends 'bookings/layout.html' %}

{% block content %}
<div class="container mx-auto px-4 py-10">

    <!-- Header Section (No changes here) -->
    <div class="text-center mb-12">
        <a href="/" class="text-3xl font-bold text-amber-50 align-middle">Welcome to</a>
        <br>
        <a href="/" class="text-6xl font-bold text-amber-50"> Roombooking</a>
        <p class="mt-4 text-center">Book your rooms easily and efficiently.</p>
    </div>

    <!-- Main Flexbox Layout (No changes here) -->
    <div class="flex flex-col md:flex-row gap-12 items-start">

        <!-- ===== LEFT COLUMN: Booking Form (No changes here) ===== -->
        <div class="w-full md:w-2/5 lg:w-1/3 bg-gray-900/50 p-6 rounded-lg shadow-lg">
            <h2 class="text-2xl font-semibold text-amber-50 mb-4">Check Room Availability</h2>
            <form action="{% url 'check_booking' %}" method="get">
                <div class="space-y-4">
                    <div>
                        <label for="room" class="block mb-1">Room:</label>
                        <select name="room" id="room" class="w-full p-2 rounded bg-gray-700 text-white border border-gray-600 focus:outline-none focus:ring-2 focus:ring-amber-400">
                            {% for room in rooms %}
                            <option value="{{ room.id }}" {% if room.id|stringformat:"s" == selected_room %}selected{% endif %}>
                                {{ room.name }}
                            </option>
                            {% endfor %}
                        </select>
                    </div>
                    <div>
                        <label for="day" class="block mb-1">Day:</label>
                        <select name="day" id="day" class="w-full p-2 rounded bg-gray-700 text-white border border-gray-600 focus:outline-none focus:ring-2 focus:ring-amber-400">
                            <option value="0" {% if selected_day == "0" %}selected{% endif %}>Monday</option>
                            <option value="1" {% if selected_day == "1" %}selected{% endif %}>Tuesday</option>
                            <option value="2" {% if selected_day == "2" %}selected{% endif %}>Wednesday</option>
                            <option value="3" {% if selected_day == "3" %}selected{% endif %}>Thursday</option>
                            <option value="4" {% if selected_day == "4" %}selected{% endif %}>Friday</option>
                        </select>
                    </div>
                    <div>
                        <label for="start_time" class="block mb-1">Time:</label>
                        <select name="start_time" id="time" class="w-full p-2 rounded bg-gray-700 text-white border border-gray-600 focus:outline-none focus:ring-2 focus:ring-amber-400">
                            <option value="9" {% if selected_time == "9" %}selected{% endif %}>09:00</option>
                            <option value="10" {% if selected_time == "10" %}selected{% endif %}>10:00</option>
                            <option value="11" {% if selected_time == "11" %}selected{% endif %}>11:00</option>
                            <option value="12" {% if selected_time == "12" %}selected{% endif %}>12:00</option>
                            <option value="13" {% if selected_time == "13" %}selected{% endif %}>13:00</option>
                            <option value="14" {% if selected_time == "14" %}selected{% endif %}>14:00</option>
                            <option value="15" {% if selected_time == "15" %}selected{% endif %}>15:00</option>
                            <option value="16" {% if selected_time == "16" %}selected{% endif %}>16:00</option>
                            <option value="17" {% if selected_time == "17" %}selected{% endif %}>17:00</option>
                        </select>
                    </div>
                </div>

                <button type="submit" class="mt-6 w-full px-4 py-2 bg-amber-400 hover:bg-amber-500 text-amber-950 font-bold rounded-lg transition-colors">
                    Check Availability
                </button>
            </form>

            {% if booking_status%}
            <div class="mt-6 p-4 rounded-lg {% if show_booking_button %}bg-green-900/50 border border-green-700{% else %}bg-red-900/50 border border-red-700{% endif %}">
                <h3 class="text-xl font-semibold text-amber-50">Booking Status</h3>
                <p class="mt-2 text-lg">{{ booking_status }}</p>
            </div>
            {% endif %}

            {% if show_booking_button %}
            <form action="{% url 'create_booking' %}" method="post" class="mt-4">
                {% csrf_token %}
                <input type="hidden" name="room_id" value="{{ request.GET.room }}">
                <input type="hidden" name="day" value="{{ request.GET.day }}">
                <input type="hidden" name="start_time" value="{{ request.GET.start_time }}">
                <button type="submit" class="w-full px-4 py-2 bg-green-600 hover:bg-green-700 text-white font-bold rounded-lg transition-colors">
                    Create Booking
                </button>
            </form>
            {% endif %}
        </div>


        <!-- ===== RIGHT COLUMN: Room Slideshow (No changes here) ===== -->
        <div class="w-full md:w-3/5 lg:w-2/3">
            <h2 class="text-2xl font-semibold text-amber-50 mb-4">Our Rooms</h2>
            <div class="swiper mySwiper h-96 rounded-lg shadow-lg">
                <div class="swiper-wrapper">
                    {% for room in rooms %}
                    <div class="swiper-slide group relative overflow-hidden bg-gray-900">
                        <a href="{% url 'room_detail' room.id %}" class="block w-full h-full">
                            <img src="{{ room.image_url }}" alt="Image of {{ room.name }}" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110">
                            <div class="absolute inset-0 bg-black/60 flex flex-col justify-center items-center text-center p-4 opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                                <h3 class="text-3xl font-bold text-white">{{ room.name }}</h3>
                                <p class="mt-2 text-lg text-gray-200">Capacity: {{ room.capacity }} people</p>
                            </div>
                        </a>
                    </div>
                    {% endfor %}
                </div>
                <div class="swiper-button-next"></div>
                <div class="swiper-button-prev"></div>
                <div class="swiper-pagination"></div>
            </div>
        </div>

    </div>

</div>
{% endblock %}


<!-- MOVED SCRIPT INTO THE NEW BLOCK -->
{% block javascript %}
<script>
    var swiper = new Swiper(".mySwiper", {
        slidesPerView: 1,
        spaceBetween: 30,
        loop: true,
        autoplay: {
            delay: 4000,
            disableOnInteraction: false,
        },
        pagination: {
            el: ".swiper-pagination",
            clickable: true,
        },
        navigation: {
            nextEl: ".swiper-button-next",
            prevEl: ".swiper-button-prev",
        },
        breakpoints: {
            768: {
                slidesPerView: 2,
                spaceBetween: 20
            }
        }
    });
</script>
{% endblock %}